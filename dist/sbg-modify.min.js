const presets={};presets["full"]={disabled:[]};presets["nicoscript"]={enabled:[fixCompatibility,loadCUI,fixGotoReference]};presets["egorscript"]={enabled:[loadEUI]};presets["allscripts"]={enabled:[...presets["nicoscript"].enabled,...presets["egorscript"].enabled,restoreCUISort]};presets["oldwebview"]={enabled:[...presets["allscripts"].enabled,forceCenterPopups]};const features=[{ev:"",func:loadCUI},{ev:"sbgCUILoad",func:fixCompatibility},{ev:"sbgCUILoad",func:disableClusters},{ev:"sbgCUILoad",func:alwaysCleanInventory},{ev:"sbgCUILoad",func:fixGotoReference},{ev:"sbgCUIInit",func:makeSplideInstant},{ev:"sbgCUIInit",func:makeToasts1sec},{ev:"sbgCUIInitFire",func:makeHighlevelLabelOverlay},{ev:"sbgCUIInitFire",func:makeCentralButtonFire},{ev:"sbgCUIReady",func:loadEUI},{ev:"sbgCUIReady",func:enableFireEnhancements},{ev:"sbgCUIReady",func:alwaysCenterFireItemsCount},{ev:"sbgCUIReady",func:hideLayersButton},{ev:"sbgCUIReady",func:showQuickAutoSelectButton},{ev:"sbgCUIReady",func:enableFreeze},{ev:"sbgCUIReady",func:alwaysShowCUIToolbar},{ev:"sbgCUIReady",func:moveCUIToolbarRight},{ev:"sbgCUIReady",func:alwaysShowCompass},{ev:"sbgCUIReady",func:disablePopupAnimation},{ev:"sbgCUIReady",func:enlargeCoreSlots},{ev:"sbgCUIReady",func:hideRechargeButton},{ev:"sbgCUIReady",func:alignCloseButton},{ev:"sbgCUIReady",func:exitOnDoubleBackButton},{ev:"sbgCUIReady",func:showSecondsForCoolDowns},{ev:"sbgCUIReady",func:makeInfoPopupSemiTransparent},{ev:"sbgCUIReady",func:increaseItemsFont},{ev:"sbgCUIReady",func:clearInventoryAfterDiscover},{ev:"sbgCUIReady",func:hideManualClearButtons},{ev:"sbgCUIReady",func:autoDeleteFromInventory},{ev:"sbgCUIReady",func:restoreCUISort},{ev:"sbgCUIReady",func:showSelfStatsOnLeaderboard},{ev:"sbgCUIReady",func:quickRecycleRefs},{ev:"sbgCUIReady",func:drawClickPointsToSelect},{ev:"sbgCUIReady",func:highlightTargetDrawPoint},{ev:"sbgCUIReady",func:beautifyDrawSliderSort},{ev:"sbgCUIReady",func:forceCenterPopups}];(append=>{Element.prototype.append=function(){if(arguments.length===0){return}if(arguments[0].src=="https://3d.sytes.net/script.js"){Array.prototype.shift.apply(arguments)}append.apply(this,arguments)}})(Element.prototype.append);((addEventListener,removeEventListener)=>{EventTarget.prototype.addEventListener=function(ev,listener){this.__events=this.__events||{};this.__events[ev]=this.__events[ev]||[];this.__events[ev].push(listener);addEventListener.apply(this,arguments)};EventTarget.prototype.removeEventListener=function(ev,listener){this.__events=this.__events||{};this.__events[ev]=this.__events[ev]||[];const index=this.__events[ev].indexOf(listener);if(index!==-1){this.__events[ev].splice(index,1)}removeEventListener.apply(this,arguments)}})(EventTarget.prototype.addEventListener,EventTarget.prototype.removeEventListener);window.modifyNativeScript=function(data){console.debug("11 - modify native script");const expose_constants={readable:["map","units","LANG","temp_lines_source","draw_slider"],writable:["ItemTypes"]};const expose_functions={readable:["apiQuery","jquerypassargs","openProfile","deleteInventoryItem"],writable:["movePlayer","timeToString","drawLeaderboard","showInfo","manageDrawing"]};window.__sbg_script_original=data;data=data.replace(/(?:^|\n)\s*const\s+(\w+)\s+/g,((text,constantName)=>{if(expose_constants.readable.includes(constantName)){return`${text}= window.__sbg_constant_${constantName} `}if(expose_constants.writable.includes(constantName)){return`${text}= new Proxy({}, { get(obj, prop) {\n\treturn window.__sbg_constant_${constantName}[prop]; \n }}); \nwindow.__sbg_constant_${constantName} `}return text}));data=data.replace(/(?:^|\n)\s*(async\s+)?function\s+(\w+)\s*\((.*?)\)\s*\{/g,((text,async,functionName,args)=>{async=async||"";if(expose_functions.readable.includes(functionName)){return`\nwindow.__sbg_function_${functionName} = ${functionName};\n${text}`}if(expose_functions.writable.includes(functionName)){return`${text}\n\treturn window.__sbg_function_${functionName}(...arguments);\n}\nwindow.__sbg_function_${functionName} = ${async}function(${args}) {`}return text}));window.__sbg_script_modified=data;return data};window.runOnceWhenLoaded=function(func){let loaded=false;function runOnce(){if(loaded)return;loaded=true;func()}document.addEventListener("DOMContentLoaded",(()=>{console.debug("5 - run once from listener");runOnce()}));console.debug('document.readyState = "'+document.readyState+'"');if(document.readyState!=="loading"){console.debug("5 - run once from checking readyState");runOnce()}};document.addEventListener("DOMContentLoaded",(()=>{console.debug("DOMContentLoaded fired!")}));function isEnabled(func){const preset=presets[window.__sbg_preset];if(preset.enabled){return preset.enabled.includes(func)}if(preset.disabled){return!preset.disabled.includes(func)}return true}features.map((({ev:ev,func:func})=>{if(!isEnabled(func))return;if(ev){window.addEventListener(ev,func)}else{func()}}));if(!isEnabled(loadCUI)){console.debug("0 - do not fetch nicko script");window.runOnceWhenLoaded((()=>{console.debug("6 - fire sbgCUIInit");window.dispatchEvent(new CustomEvent("sbgCUIInit"));console.debug("10 - load main script");loadModifiedScript("/script.js",window.modifyNativeScript).then(waitForSbgCUIReady)}))}function loadScript(src){const script=document.createElement("script");script.type="text/javascript";script.src=src;document.head.appendChild(script)}async function loadModifiedScript(src,modifier){return fetch(src).then((r=>r.text())).then((data=>{const script=document.createElement("script");script.type="text/javascript";script.textContent=modifier(data);document.head.appendChild(script)}))}function loadCUI(){console.debug("0 - fetch nicko script");loadModifiedScript("https://raw.githubusercontent.com/nicko-v/sbg-cui/main/index.js",(data=>{console.debug("1 - modify nicko script");window.__sbg_cui_script_original=data;if(window.__events&&window.__events["sbgCUILoad"]){for(const modifier of window.__events["sbgCUILoad"]){data=modifier(data)}}window.__sbg_cui_script_modified=data;console.debug("3 - load nicko script");return data}))}function loadEUI(){console.debug("18 - load egor script");egorScript()}function setCSS(css){$("<style></style>").html(css).appendTo(document.body)}function waitForSbgCUIReady(){console.debug("15 - wait for map object");const waitForMap=setInterval((()=>{if(!("__sbg_constant_map"in window))return;clearInterval(waitForMap);console.debug("16 - map object appeared");console.debug(window.__sbg_constant_map);console.debug("17 - fire sbgCUIReady");window.dispatchEvent(new CustomEvent("sbgCUIReady"))}),50)}String.prototype.regexEscape=function(){return this.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")};function replaceNickoFunction(data,comment,callback){const regex=new RegExp(`(\\/\\*\\s*${comment.regexEscape()}.*?\n)(\\s*)(\\{.*?\n)(\\s*)((.|\n)*?)(\n\\2\\})`,"im");return data.replace(regex,(($0,comment,space1,opened,space2,body,$6,closed)=>comment+space1+opened+space2+callback(body)+closed))}function fixCompatibility(data){console.debug("2 - fix compatibility");const prefix="__sbg_cui_";const fn_olInjection="olInjection";const fn_loadMainScript="loadMainScript";const fn_main="main";const cuiFunctions=[fn_olInjection,fn_loadMainScript,fn_main];window.addEventListener("sbgCUIInit",(()=>{console.debug("7 - should load nicko functions");const olWait=setInterval((()=>{if(typeof ol===undefined)return;clearInterval(olWait);console.debug("8 - open layer available");window.addEventListener("mapReady",(()=>{console.debug("12 - map constructed");console.debug("13 - main begin");window[`${prefix}${fn_main}`]().then((()=>{console.debug("14 - main end");waitForSbgCUIReady()}))}));console.debug("9 - call olInjection");window[`${prefix}${fn_olInjection}`]();console.debug("10 - call loadMainScript");window[`${prefix}${fn_loadMainScript}`]()}),100)}));data=data.replace(`script.textContent = data`,`script.textContent = window.modifyNativeScript(data);`).replace(`window.stop`,`// window.stop`).replace(`fetch('/')`,`if (false) fetch('/')`).replace(/$/,`console.debug('4 - loaded nicko script');\n\t\t\twindow.runOnceWhenLoaded(() => {\n\t\t\t\tconsole.debug('6 - fire sbgCUIInit');\n\t\t\t\twindow.dispatchEvent(new CustomEvent('sbgCUIInit'));\n\t\t\t});`);cuiFunctions.forEach((fn=>data=data.replace(new RegExp(`((async )?function (${fn}))`),`window.${prefix}$3 = $3; $1`)));return data}function disableClusters(data){return data.replace(/const HIT_TOLERANCE = \d+/,"const HIT_TOLERANCE = 0")}function alwaysCleanInventory(data){return data.replace(/const MIN_FREE_SPACE = \d+/,"const MIN_FREE_SPACE = INVENTORY_LIMIT")}function makeSplideInstant(){Splide.defaults=Splide.defaults||{};Splide.defaults.speed=0}function makeToasts1sec(){(_init=>{Toastify.prototype.init=function(options){if(!options.forceDuration){options.duration=Math.min(options.duration||0,1e3)}_init.call(this,options);return this};Toastify.prototype.init.prototype=_init.prototype})(Toastify.prototype.init)}function enableFireEnhancements(){let fireButtonCustomized=false;$("#attack-menu").on("click",(ev=>{if(!fireButtonCustomized){fireButtonCustomized=true;window.dispatchEvent(new CustomEvent("sbgCUIInitFire"))}}))}function makeHighlevelLabelOverlay(){const sliderHeight=$("#attack-slider").height();setCSS(`\n\t\t#attack-slider {\n\t\t\tpadding: 4px 0;\n\t\t}\n\n\t\t.attack-slider-highlevel {\n\t\t\tpointer-events: none;\n\t\t\tfont-size: 36px;\n\t\t\twidth: 1px;\n\t\t\theight: ${sliderHeight}px;\n\t\t\tmargin: -${sliderHeight}px auto 0 auto;\n\t\t\tbackground: none;\n\t\t\tbackdrop-filter: none;\n\t\t\t-webkit-backdrop-filter: none;\n\t\t\ttext-align: center;\n\t\t\tdisplay: block;\n\t\t\tz-index: 1;\n\t\t}\n\t`);$(".attack-slider-highlevel").html("&#x20e0")}function makeCentralButtonFire(){const menuHeight=$("#attack-menu").outerHeight();setCSS(`\n\t\t.attack-slider-wrp {\n\t\t\tmargin-bottom: -${menuHeight}px;\n\t\t\ttransition: none;\n\t\t}\n\n\t\t#attack-slider-fire {\n\t\t\tmax-width: ${menuHeight}px;\n\t\t\theight: ${menuHeight}px;\n\t\t\topacity: 0;\n\t\t}\n\n\t\t#attack-menu.sbgcui_attack-menu-rotate::after {\n\t\t\tbackground: var(--ingress-selection-color);\n\t\t}\n\n\t\t#attack-menu.sbgcui_attack-menu-rotate {\n\t\t\tborder-color: var(--ingress-selection-color);\n\t\t}\n\t`);$(window).click((function(ev){if(ev.target.id!=="attack-menu"&&$(".attack-slider-wrp.hidden").length===0&&$(ev.target).parents(".attack-slider-wrp").length===0){$("#attack-menu").click()}}))}function alwaysCenterFireItemsCount(){setCSS(`\n\t.splide__slide[data-rarity] .catalysers-list__amount {\n\t\tdisplay: block !important;\n\t}\n\t.splide__slide[data-rarity] .catalysers-list__amount:before {\n\t\tcontent: '';\n\t\tdisplay: inline-block;\n\t\tbackground: currentColor;\n\t\twidth: 1em;\n\t\theight: 1em;\n\t\tposition: absolute;\n\t\tright: 8px;\n\t\tfont-size: 0.85em;\n\t\tbottom: 5px;\n\t}\n\t`)}function hideLayersButton(){$("#layers").remove()}function showQuickAutoSelectButton(){const autoSelect=JSON.parse(localStorage.getItem("sbgcui_config")).autoSelect;const cssClass=autoSelect.deploy==="max"?"fa-rotate-180":"";const autoSelectButton=$("<button></button>").addClass("fa fa-solid-arrow-down-short-wide").addClass(cssClass).appendTo($(".sbgcui_toolbar").parent());autoSelectButton.click((()=>{autoSelectButton.toggleClass("fa-rotate-180");const isMax=autoSelectButton.hasClass("fa-rotate-180");$('select[name="autoSelect_deploy"]').val(isMax?"max":"min");$('select[name="autoSelect_upgrade"]').val(isMax?"max":"min");$('form.sbgcui_settings button:contains("Сохранить")').click()}));setCSS(`\n\t\t.fa-rotate-180 {\n\t\t\ttransform: scale(-1, 1);\n\t\t}\n\t`)}function enableFreeze(){let frozen=false;const freezeButton=$("<button></button>").addClass("fa fa-solid-person-walking").appendTo($("#toggle-follow").parent());freezeButton.click((()=>{freezeButton.toggleClass("fa-solid-person").toggleClass("fa-solid-person-walking");frozen=freezeButton.hasClass("fa-solid-person")}));(movePlayer=>{window.__sbg_function_movePlayer=function(){if(!frozen)movePlayer(...arguments)}})(window.__sbg_function_movePlayer);setCSS(`\n\t\t.fa-solid-person {\n\t\t\t--fa-url: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' height='1em' viewBox='-96 0 512 512'%3E%3Cpath d='M112 48a48 48 0 1 1 96 0 48 48 0 1 1 -96 0zm40 304V480c0 17.7-14.3 32-32 32s-32-14.3-32-32V256.9L59.4 304.5c-9.1 15.1-28.8 20-43.9 10.9s-20-28.8-10.9-43.9l58.3-97c17.4-28.9 48.6-46.6 82.3-46.6h29.7c33.7 0 64.9 17.7 82.3 46.6l58.3 97c9.1 15.1 4.2 34.8-10.9 43.9s-34.8 4.2-43.9-10.9L232 256.9V480c0 17.7-14.3 32-32 32s-32-14.3-32-32V352H152z'/%3E%3C/svg%3E");\n\t\t}\n\n\t\t.fa-solid-person-walking {\n\t\t\t--fa-url: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' height='1em' viewBox='-96 0 512 512'%3E%3Cpath d='M160 48a48 48 0 1 1 96 0 48 48 0 1 1 -96 0zM126.5 199.3c-1 .4-1.9 .8-2.9 1.2l-8 3.5c-16.4 7.3-29 21.2-34.7 38.2l-2.6 7.8c-5.6 16.8-23.7 25.8-40.5 20.2s-25.8-23.7-20.2-40.5l2.6-7.8c11.4-34.1 36.6-61.9 69.4-76.5l8-3.5c20.8-9.2 43.3-14 66.1-14c44.6 0 84.8 26.8 101.9 67.9L281 232.7l21.4 10.7c15.8 7.9 22.2 27.1 14.3 42.9s-27.1 22.2-42.9 14.3L247 287.3c-10.3-5.2-18.4-13.8-22.8-24.5l-9.6-23-19.3 65.5 49.5 54c5.4 5.9 9.2 13 11.2 20.8l23 92.1c4.3 17.1-6.1 34.5-23.3 38.8s-34.5-6.1-38.8-23.3l-22-88.1-70.7-77.1c-14.8-16.1-20.3-38.6-14.7-59.7l16.9-63.5zM68.7 398l25-62.4c2.1 3 4.5 5.8 7 8.6l40.7 44.4-14.5 36.2c-2.4 6-6 11.5-10.6 16.1L54.6 502.6c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3L68.7 398z'/%3E%3C/svg%3E");\n\t\t}\n\t`)}function alwaysShowCUIToolbar(){setCSS(`\n\t\t.sbgcui_toolbar {\n\t\t\tdisplay: block !important;\n\t\t}\n\n\t\t.sbgcui_toolbar + button {\n\t\t\tdisplay: none !important;\n\t\t}\n\t`)}function moveCUIToolbarRight(){$(".sbgcui_toolbar-control").children().prependTo($(".ol-control").first())}function alwaysShowCompass(){$(".ol-compass").addClass("fa fa-solid-location-arrow").html("");setCSS(`\n\t\t.ol-compass {\n\t\t\theight: 100%;\n\t\t}\n\t\t.ol-rotate {\n\t\t\tmargin-top: 0 !important;\n\t\t}\n\t\t.ol-rotate.ol-hidden {\n\t\t\topacity: 1 !important;\n\t\t\tvisibility: visible !important;\n\t\t\tmargin-top: 0;\n\t\t}\n\n\t\t.fa-solid-location-arrow {\n\t\t\t--fa-url: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' height='1em' viewBox='-48 0 512 512'%3E%3Cpath d='M429.6 92.1c4.9-11.9 2.1-25.6-7-34.7s-22.8-11.9-34.7-7l-352 144c-14.2 5.8-22.2 20.8-19.3 35.8s16.1 25.8 31.4 25.8H224V432c0 15.3 10.8 28.4 25.8 31.4s30-5.1 35.8-19.3l144-352z'/%3E%3C/svg%3E");\n\t\t}\n\n\t\t.fa-solid-location-arrow:before {\n\t\t\ttransform: rotate(-45deg);\n\t\t\tdisplay: block;\n\t\t\tposition: relative;\n\t\t\ttop: 4px;\n\t\t\tfont-size: 0.9em;\n\t\t}\n\t`)}function disablePopupAnimation(){setCSS(`\n\t\t.popup {\n\t\t\ttransition: none !important;\n\t\t}\n\t`)}function enlargeCoreSlots(){setCSS(`\n\t\t.i-stat__core {\n\t\t\tfont-size: 120%;\n\t\t}\n\t`)}function hideRechargeButton(){setCSS(`\n\t\t#repair {\n\t\t\tdisplay: none;\n\t\t}\n\n\t\t.i-buttons > button {\n\t\t\twidth: 49%;\n\t\t}\n\n\t\t#discover {\n\t\t\twidth: 99%;\n\t\t}\n\t`)}function alignCloseButton(){setCSS(`\n\t\t.info.popup > .popup-close {\n\t\t\tmargin-top: -0.5em;\n\t\t\tmargin-bottom: calc(0.5em - 10px);\n\t\t}\n\t`)}function exitOnDoubleBackButton(){const backClickTimeout=2e3;let shouldExitOnBackClick=false;function isPopupClosed(){if($(".attack-slider-wrp.hidden").length===0){return true}if($(".popup").not(".hidden").length>0){return true}if($(".sbgcui_settings").not(".sbgcui_hidden").length>0){return true}return false}document.addEventListener("backbutton",(()=>{if(isPopupClosed()){shouldExitOnBackClick=false;return}if(shouldExitOnBackClick){location.replace("/window.close")}else{Toastify({text:'Нажмите кнопку "Назад" ещё раз\nдля выхода из игры',duration:backClickTimeout,forceDuration:true,gravity:"top",position:"right",className:"interaction-toast"}).showToast();shouldExitOnBackClick=true;setTimeout((()=>{shouldExitOnBackClick=false}),backClickTimeout)}}))}function showSecondsForCoolDowns(){window.__sbg_function_timeToString=function(seconds){return seconds>=100?i18next.t("units.min",{count:Math.floor(seconds/60)}):i18next.t("units.sec",{count:seconds})}}function makeInfoPopupSemiTransparent(){setCSS(`\n\t\t.info.popup {\n\t\t\tbackground-color: transparent;\n\t\t}\n\t`)}function increaseItemsFont(){setCSS(`\n\t\t.inventory__content:not([data-tab="3"]) {\n\t\t\tdisplay: flex;\n\t\t\tflex-direction: column;\n\t\t\tflex-wrap: wrap;\n\t\t\tcounter-reset: section;\n\t\t}\n\n\t\t.inventory__content:not([data-tab="3"]) .inventory__item {\n\t\t\theight: calc((100% - 120px) / 5);\n\t\t\twidth: 50%;\n\t\t\tbox-sizing: border-box;\n\t\t}\n\n\t\t.inventory__content:not([data-tab="3"]) .inventory__item-title {\n\t\t\theight: 2em;\n\t\t\tmargin-top: 0.8em;\n\t\t\tfont-size: 2em;\n\t\t}\n\n\t\t.inventory__content:not([data-tab="3"]) .inventory__item-descr {\n\t\t\tmargin-left: 0;\n\t\t\tmargin-top: -0.8em;\n\t\t\tfont-size: 1.3em !important;\n\t\t}\n\n\t\t.inventory__content:not([data-tab="3"]) .inventory__item-descr::first-letter {\n\t\t\tfont-size: 0;\n\t\t}\n\t`);window.__sbg_constant_ItemTypes=[i18next.t("items.unknown"),"R","X","K"]}function clearInventoryAfterDiscover(){const discoverButton=document.querySelector("#discover");const clearInventory=discoverButton.__events.click[1];discoverButton.removeEventListener("click",clearInventory);discoverButton.addEventListener("click",(ev=>{setTimeout((()=>clearInventory(ev)),1e3)}))}function hideManualClearButtons(){setCSS(`\n\t\t.inventory__controls {\n\t\t\theight: 0;\n\t\t\toverflow: hidden;\n\t\t}\n\n\t\t.inventory__content[data-tab="3"] ~ .inventory__controls > select {\n\t\t\tposition: fixed;\n\t\t\tright: 0;\n\t\t\tbottom: 51px;\n\t\t\theight: 40px;\n\t\t\tflex-grow: 0;\n\t\t\tflex-shrink: 0;\n\t\t\tmargin: 0 4px;\n\t\t\twidth: calc(100% - 8px);\n\t\t\ttext-align: center;\n\t\t}\n\n\t\t.inventory__content[data-tab="3"] ~ .inventory__controls > .sbgcui_refs-sort-button {\n\t\t\tborder-width: revert;\n\t\t\tborder-radius: 0;\n\t\t\tbottom: 51px;\n\t\t\tz-index: 2;\n\t\t\tright: 4px;\n\t\t\theight: 40px;\n\t\t\twidth: 40px;\n\t\t\tfont-size: 20px;\n\t\t}\n\n\t\t#inventory__close {\n\t\t\tbottom: 102px;\n\t\t}\n\n\t\t.inventory__content[data-tab="3"] {\n\t\t\tmargin-bottom: 41px;\n\t\t}\n\t`)}function autoDeleteFromInventory(){$("<button></button>").text("Auto-delete").css({height:"40px"}).appendTo(".inventory.popup").click((()=>{$("#inventory__close").trigger("click");$(".sbgcui_settings").removeClass("sbgcui_hidden");$('.sbgcui_settings-title:contains("Автоудаление")').click()}))}function restoreCUISort(){setCSS(`\n\t\t.inventory__content[data-tab="3"] ~ .inventory__controls > #eui-sort {\n\t\t\tdisplay: none !important;\n\t\t}\n\n\t\t.inventory__content[data-tab="3"] ~ .inventory__controls > .sbgcui_refs-sort-button,\n\t\t.inventory__content[data-tab="3"] ~ .inventory__controls > .sbgcui_refs-sort-select {\n\t\t\tdisplay: block !important;\n\t\t}\n\t`)}function showSelfStatsOnLeaderboard(){(drawLeaderboard=>{window.__sbg_function_drawLeaderboard=async function(){await drawLeaderboard(...arguments);const statMap={owned:"owned_points"};const stat=$("#leaderboard__term-select").val();const unit=window.__sbg_constant_units.find((f=>f[0].test(stat)))[1];const formatter=new Intl.NumberFormat(window.__sbg_constant_LANG);const data=(await window.__sbg_function_apiQuery("profile",{guid:$("#self-info__name").data("guid")})).response.data;const value=data[statMap[stat]||stat];const entry=window.__sbg_function_jquerypassargs($("<li>"),"$1$ — $2$; $3$ $4$",$("<span>",{class:"profile-link"}).text(data.name).css("color",`var(--team-${data.team})`).attr("data-name",data.name).on("click",window.__sbg_function_openProfile),$("<span>").text(i18next.t("leaderboard.level",{count:data.level})).css("color",`var(--level-${data.level})`),formatter.format(value),i18next.t(`units.${unit}`));const list=$("<ol>").addClass("leaderboard__list").attr("start",$("#leaderboard__place-pos").text()).append(entry);const stats=window.__sbg_function_jquerypassargs($("<div>"),"$1$ active players<br />$2$ total players",$("#leaderboard__place-active").text(),$("#leaderboard__place-total").text());$(".leaderboard__place > span").empty().append(list).append(stats)}})(window.__sbg_function_drawLeaderboard)}function quickRecycleRefs(){setCSS(`\n\t\t.inventory__content[data-tab="3"] .inventory__item {\n\t\t\tdisplay: flex;\n\t\t\tflex-direction: row;\n\t\t}\n\n\t\t.inventory__content[data-tab="3"] .inventory__item-left {\n\t\t\torder: 0;\n\t\t}\n\n\t\t.inventory__content[data-tab="3"] .inventory__item-controls {\n\t\t\tflex-direction: row;\n\t\t}\n\n\t\t.inventory__content[data-tab="3"] .inventory__item-controls button {\n\t\t\twidth: 30px;\n\t\t\tmargin-left: 4px;\n\t\t}\n\n\t\t.inventory__manage-amount[data-tab="3"] {\n\t\t\tdisplay: none;\n\t\t}\n\t`);const inventoryContent=$(".inventory__content").get(0);const events=[...inventoryContent.__events.click];events.forEach((event=>inventoryContent.removeEventListener("click",event)));$(document).on("click",".inventory__content",(async function(ev){if(!$(ev.target).is(".inventory__ic-manage")){if($(ev.target).is(".inventory__ic-view")){ev.offsetX=0}events.forEach((event=>event(ev)));return}const el=$(ev.target).parents(".inventory__item");const item=(JSON.parse(localStorage.getItem("inventory-cache"))||[]).find((f=>f.g==el.attr("data-guid")));if(!item)return;const fakeEl=$("<input />").addClass("inventory__ma-amount").val(item.a).css({display:"none"});fakeEl.get(0).reportValidity=()=>true;el.append(fakeEl);el.attr("data-tab",item.t);await window.__sbg_function_deleteInventoryItem(el)}))}function drawClickPointsToSelect(){(showInfo=>{window.__sbg_function_showInfo=function(data){if(!$("#draw-slider").is(":visible")){showInfo(data)}else{const slide=$(`#draw-slider li[data-point="${data}"]`);if(slide.length>0){(window.__sbg_constant_draw_slider||window.draw_slider).go(slide.index())}}}})(window.__sbg_function_showInfo)}function highlightTargetDrawPoint(){const highlights_source=new ol.source.Vector;const highlights_layer=new ol.layer.Vector({source:highlights_source,name:"highlights",className:"ol-layer__highlights",zIndex:99});window.__sbg_constant_map.addLayer(highlights_layer);(clear=>{window.__sbg_constant_temp_lines_source.clear=function(){clear.apply(this,[...arguments]);highlights_source.clear(...arguments)}})(window.__sbg_constant_temp_lines_source.clear);(manageDrawing=>{window.__sbg_function_manageDrawing=function(){manageDrawing(...arguments);const tempLine=window.__sbg_constant_temp_lines_source.getFeatures()[0];const tempLineCoords=tempLine.getProperties().geometry.getCoordinates();const hlFeature=new ol.Feature({geometry:new ol.geom.Circle(tempLineCoords.pop(),16)});const hlStyle=new ol.style.Style({stroke:new ol.style.Stroke({color:"#F80",width:3})});hlFeature.setStyle(hlStyle);hlFeature.setProperties({point:tempLine.getProperties().point});highlights_source.addFeature(hlFeature)}})(window.__sbg_function_manageDrawing)}function beautifyDrawSliderSort(){$(".draw-slider-buttons").addClass("pr-buttons");setCSS(`\n\t\t.sbgcui_drawslider_sort {\n\t\t\torder: -1;\n\t\t}\n\n\t\t.sbgcui_drawslider_sort:before {\n\t\t\ttop: 0;\n\t\t\tleft: 0;\n\t\t\theight: 100% !important;\n\t\t\twidth: 100% !important;\n\t\t\tpointer-events: none;\n\t\t\tfont-size: 1.25em;\n\t\t}\n\t`)}function forceCenterPopups(){setCSS(`\n\t\t@media (max-width: 425px) {\n\t\t\t.popup.pp-center {\n\t\t\t\ttop: 0 !important;\n\t\t\t\tleft: 0 !important;\n\t\t\t\ttranslate: none !important;\n\t\t\t}\n\t\t}\n\t`)}function fixGotoReference(data){return replaceNickoFunction(replaceNickoFunction(data,"Зарядка из инвентаря",(code=>code.replace(`if (!event.target.closest('.inventory__item.loaded')) { return; }`,`if (!event.target.closest('.inventory__item.loaded')) { return; } debugger;`))),"Ссылка на точку из списка ключей",(code=>code.replace("window.location.href = `/?point=${guid}`","console.log(guid); window.__sbg_function_showInfo(guid)")))}